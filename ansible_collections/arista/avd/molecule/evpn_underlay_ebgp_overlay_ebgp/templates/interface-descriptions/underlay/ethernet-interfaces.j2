{% set tags = lookup("arista.avd.get_node_config", "_tags") %}
{% if link.type is arista.avd.defined('underlay_p2p') %}
{%     if tags is arista.avd.defined %}
CUSTOM_P2P_LINK_TO_{{ link.peer | upper }}_{{ link.peer_interface }} {{ tags | arista.avd.default }}
{%     else %}
CUSTOM_P2P_LINK_TO_{{ link.peer | upper }}_{{ link.peer_interface }}
{%     endif %}
{% elif link.type is arista.avd.defined('underlay_l2') %}
{%     if tags is arista.avd.defined %}
CUSTOM_{{ link.peer | upper }}_{{ link.peer_interface }} {{ tags | arista.avd.default }}
{%     else %}
CUSTOM_{{ link.peer | upper }}_{{ link.peer_interface }}
{%     endif %}
{% endif %}
